# /review-architecture 커맨드

클린 아키텍처와 DDD 관점에서 코드를 분석하고 리뷰 문서를 작성합니다.

## 사용법

```
/review-architecture [경로]
```

## 설명

지정된 경로(또는 현재 디렉토리)의 코드를 클린 아키텍처 및 DDD 원칙에 따라 분석하고, 잘 구현된 점과 개선이 필요한 점을 문서화합니다.

## 실행 단계

### 1단계: 구조 스캔

대상 경로의 전체 구조를 분석합니다:
- 디렉토리 및 파일 목록 스캔
- 레이어 구조 파악 (Domain, Application, Infrastructure, Presentation)
- 주요 클래스/모듈 식별

### 2단계: 클린 아키텍처 분석

다음 항목을 체크합니다:

| 체크 항목 | 설명 |
|----------|------|
| 의존성 방향 | 모든 의존성이 안쪽(Domain)으로만 향하는가? |
| Domain 독립성 | Domain 레이어에 프레임워크, DB, 외부 라이브러리 의존성이 없는가? |
| 레이어 분리 | 각 레이어의 책임이 명확히 구분되어 있는가? |
| 인터페이스 분리 | Repository, Gateway 등의 인터페이스가 Domain에 정의되어 있는가? |
| Use Case 분리 | 각 Use Case가 단일 책임을 가지고 있는가? |

### 3단계: DDD 분석

다음 항목을 체크합니다:

| 체크 항목 | 설명 |
|----------|------|
| Rich Domain Model | Entity가 비즈니스 로직을 포함하고 있는가? (빈약한 도메인 모델 아닌지) |
| Value Object | 불변성을 보장하고 생성자에서 유효성 검증을 수행하는가? |
| Aggregate | 트랜잭션 경계가 적절하게 정의되어 있는가? |
| Aggregate Root | 외부에서 Aggregate 내부 객체에 직접 접근하지 않는가? |
| Domain Service | 여러 Entity에 걸친 로직이 Domain Service로 분리되어 있는가? |
| Repository | 컬렉션 추상화 관점의 도메인 인터페이스인가? |
| Domain Event | 도메인 간 결합도를 낮추기 위한 이벤트가 활용되고 있는가? |
| Ubiquitous Language | 코드에서 도메인 용어가 일관되게 사용되고 있는가? |

### 4단계: 강점 분석

잘 구현된 점을 식별합니다:
- 각 강점에 대해 구체적인 코드 예시 제공
- 해당 구현이 왜 좋은지 설명
- 유지해야 할 패턴으로 기록

### 5단계: 약점 분석

개선이 필요한 점을 식별합니다:
- 각 약점에 대해 문제가 되는 코드 예시 제공
- 현재 구현의 문제점과 그로 인한 영향 설명
- 위반되는 원칙 명시

### 6단계: 수정 방향 제안

우선순위별로 개선 작업을 분류합니다:

**높은 우선순위**
- 아키텍처 원칙 위반 (의존성 방향, Domain 오염 등)
- 테스트 불가능한 구조
- 확장성/유지보수성에 심각한 영향

**중간 우선순위**
- DDD 패턴 미적용 (빈약한 모델, Value Object 미사용 등)
- 레이어 간 책임 불명확

**낮은 우선순위**
- 네이밍 개선
- 코드 정리 및 리팩토링
- 문서화 개선

### 7단계: 기대 효과 산출

각 개선 작업에 대한 기대 효과를 설명합니다:
- 테스트 용이성 향상
- 유지보수성 개선
- 확장성 확보
- 코드 가독성 향상
- 버그 발생 가능성 감소

### 8단계: 리뷰 문서 출력

분석 결과를 마크다운 형식으로 출력합니다.

## 출력 형식

```markdown
# 아키텍처 리뷰: {대상명}

## 개요
- 분석 대상: {경로}
- 분석 일시: {YYYY-MM-DD HH:MM}
- 총 파일 수: {N}개
- 주요 레이어: {발견된 레이어 목록}

## 현재 구조 분석

### 디렉토리 구조
{트리 형태로 표현}

### 레이어 구성
{각 레이어별 역할과 포함된 주요 컴포넌트}

## 분석 결과 요약

| 영역 | 평가 | 비고 |
|-----|------|------|
| 의존성 방향 | ✅/⚠️/❌ | {설명} |
| Domain 독립성 | ✅/⚠️/❌ | {설명} |
| Entity 설계 | ✅/⚠️/❌ | {설명} |
| Value Object | ✅/⚠️/❌ | {설명} |
| Repository 패턴 | ✅/⚠️/❌ | {설명} |

## 잘 구현된 점 ✅

### 1. {강점 제목}
**위치**: `{파일 경로}`

{설명}

```{언어}
// 예시 코드
```

**좋은 이유**: {설명}

### 2. {강점 제목}
...

## 개선이 필요한 점 ⚠️

### 1. {약점 제목}
**위치**: `{파일 경로}`
**위반 원칙**: {CA/DDD 원칙명}

{문제점 설명}

```{언어}
// 문제가 되는 코드
```

**영향**: {영향 설명}

### 2. {약점 제목}
...

## 수정 방향 제안

### 높은 우선순위 🔴

#### 1. {개선 항목}
- **현재**: {현재 상태}
- **목표**: {개선 후 상태}
- **작업 내용**: {구체적인 작업}

### 중간 우선순위 🟡

#### 1. {개선 항목}
...

### 낮은 우선순위 🟢

#### 1. {개선 항목}
...

## 기대 효과

| 개선 항목 | 기대 효과 | 영향 범위 |
|----------|----------|----------|
| {항목1} | {효과} | {범위} |
| {항목2} | {효과} | {범위} |

## 권장 다음 단계

1. {첫 번째 권장 작업}
2. {두 번째 권장 작업}
3. {세 번째 권장 작업}

---
*이 리뷰는 클린 아키텍처와 DDD 원칙을 기준으로 작성되었습니다.*
```

## 예시

```
/review-architecture ./src/features/user-management
```

## 관련 커맨드

- `/refactor-feature [경로]` - 리뷰 결과를 바탕으로 특정 Feature 리팩토링
- `/refactor-project` - 프로젝트 전체 리팩토링 계획 수립

## 주의사항

- 리뷰는 코드 변경 없이 분석만 수행합니다
- 대규모 코드베이스의 경우 Feature 단위로 분할하여 리뷰를 권장합니다
- 리뷰 결과는 절대적인 기준이 아닌 개선 방향 제안입니다
- 프로젝트의 특성과 제약사항을 고려하여 개선 우선순위를 조정하세요
